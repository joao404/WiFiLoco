<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "rocrail.net">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
            <title>Ethernet Decoder : Config</title>
		<link rel="stylesheet" type="text/css"  href="styles.css">
		
	</head>
	<body onload="GetWebserverData()" id="inhalt">
	<header>
		<span style="float: left; cursor:pointer" onclick="openNav()">&#9776; Men&#252;</span>
		<h1 style="float: center;" >Config</h1>
    </header>
    
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a href="index.html">Home</a>
        <a href="config.html">Config</a>
        <a href="status.html">Status</a>
    </div>
    
	<br>
	<h2>mDNS</h2>
	<input type="text" name="MDNSNAME" id="mDNSName" value="LokControlDefault"/>
	<br>
	<hr>
	<h2>WLAN Station</h2>
	<p>Name:<p/>
    <br/>
	<input type="text" name="STNAME" id="STName" value=""/>
	<br/>
	<p>Passwort:<p/>
    <br/>
	<input type="text" name="STPWD" id="STPwd" value=""/>
	<br>
	<br>
        <hr>
        
        <h2>AP</h2>
        <p>Name:<p/>
        <input type="text" name="APNAME" id="APName" value="APName"/>
        <br>
        <p>Passwort:<p/>
        <input type="text" name="APPWD" id="APPwd" value="APPasswort"/>
        <br>
        <hr>
        <h2>Netzwerkkonfiguration</h2>
        <p>IP-Adresse:<p/>
                <br/>
        <input type="text" name="IP" required pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$" id="IPAdr" value="192.168.2.95"/>
	<br/>
        <p>Netzmaske:<p/>
        <input type="text" name="NM" required pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$" id="NETMSK" value="255.255.255.0"/>
	<br/>
        <p>Router-IP:<p/>
        <input type="text" name="Rtr" required pattern="^([0-9]{1,3}\.){3}[0-9]{1,3}$" id="IPRtr" value="192.168.2.1"/>
	<br/>
        <p>Rocrailport:<p/>
        <input type="number" name="Prt" id="ROCPort" value="4444"/>
	<br/>
	<p><button id="ButtonSpeichern" onclick="AjaxConfigDataExchange()">Speichern</button></p>
	
	
	<tail><a href="http://www.rocrail.net">www.rocrail.net</a> Marcel Maage 2018</tail>
	
	<script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "250px";
            document.getElementById("main").style.marginLeft = "250px";
        }

        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
            document.getElementById("main").style.marginLeft= "0";
        }
	
			function GetWebserverData()
			{
				vollbild();
				var request = new XMLHttpRequest();
				request.onreadystatechange=function()
				{
					if(this.readyState==4 && this.status==200)
					{
						if(this.responseXML != null)
						{
							//extract XML data from XML file
							document.getElementById("mDNSName").value =
								this.responseXML.getElementsByTagName('mDNSName')[0].childNodes[0].nodeValue;
							document.getElementById("STName").value =
								this.responseXML.getElementsByTagName('STName')[0].childNodes[0].nodeValue;
                            document.getElementById("STPwd").value =
								this.responseXML.getElementsByTagName('STPwd')[0].childNodes[0].nodeValue;
							document.getElementById("APName").value =
								this.responseXML.getElementsByTagName('APName')[0].childNodes[0].nodeValue;
                            document.getElementById("APPwd").value =
								this.responseXML.getElementsByTagName('APPwd')[0].childNodes[0].nodeValue;
							document.getElementById("IPAdr").value =
								this.responseXML.getElementsByTagName('IPAdr')[0].childNodes[0].nodeValue;
							document.getElementById("NETMSK").value =
								this.responseXML.getElementsByTagName('NETMSK')[0].childNodes[0].nodeValue;
							document.getElementById("IPRtr").value =
								this.responseXML.getElementsByTagName('IPRtr')[0].childNodes[0].nodeValue;
							document.getElementById("ROCPort").value =
								this.responseXML.getElementsByTagName('ROCPort')[0].childNodes[0].nodeValue;
						}
					}
				}
				request.open("GET","AjaxConfigDataExchange",true);
				request.send(null);	
				
			}
			
			function vollbild() {

			var element = document.getElementById("inhalt");

			if (element.requestFullScreen) {

				if (!document.fullScreen) {
					element.requestFullscreen();
				} else {
				document.exitFullScreen();
				}

			} else if (element.mozRequestFullScreen) {

				if (!document.mozFullScreen) {
					element.mozRequestFullScreen();
				} else {
					document.mozCancelFullScreen();
				}

			} else if (element.webkitRequestFullScreen) {

				if (!document.webkitIsFullScreen) {
					element.webkitRequestFullScreen();
				} else {
					document.webkitCancelFullScreen();
				}

			}		

			}
			
			function AjaxConfigDataExchange()
			{
				var request = new XMLHttpRequest();
				request.onreadystatechange=function()
				{
					if(this.readyState==4 && this.status==200)
					{
						if(this.responseXML != null)
						{
							//extract XML data from XML file
							document.getElementById("mDNSName").value =
								this.responseXML.getElementsByTagName('mDNSName')[0].childNodes[0].nodeValue;
							document.getElementById("STName").value =
								this.responseXML.getElementsByTagName('STName')[0].childNodes[0].nodeValue;
                            document.getElementById("STPwd").value =
								this.responseXML.getElementsByTagName('STPwd')[0].childNodes[0].nodeValue;
                            document.getElementById("APName").value =
								this.responseXML.getElementsByTagName('APName')[0].childNodes[0].nodeValue;
                            document.getElementById("APPwd").value =
								this.responseXML.getElementsByTagName('APPwd')[0].childNodes[0].nodeValue;
							document.getElementById("IPAdr").value =
								this.responseXML.getElementsByTagName('IPAdr')[0].childNodes[0].nodeValue;
							document.getElementById("NETMSK").value =
								this.responseXML.getElementsByTagName('NETMSK')[0].childNodes[0].nodeValue;
							document.getElementById("IPRtr").value =
								this.responseXML.getElementsByTagName('IPRtr')[0].childNodes[0].nodeValue;
							document.getElementById("ROCPort").value =
								this.responseXML.getElementsByTagName('ROCPort')[0].childNodes[0].nodeValue;
						}
					}
				}
				request.open("GET","AjaxConfigDataExchange?mDNSName="+document.getElementById("mDNSName").value+"&STName="+document.getElementById("STName").value+"&STPwd="+document.getElementById("STPwd").value+"&APName="+document.getElementById("APName").value+"&APPwd="+document.getElementById("APPwd").value+"&IPAdr="+document.getElementById("IPAdr").value+"&NETMSK="+document.getElementById("NETMSK").value+"&IPRtr="+document.getElementById("IPRtr").value+"&ROCPort="+document.getElementById("ROCPort").value,true);
				request.send(null);				
			}
		</script>
	
	
	
	</body>
</html>
